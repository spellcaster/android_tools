ПАКЕТ СКРИПТОВ ДЛЯ АВТОМАТИЗАЦИИ ИЗМЕНЕНИЯ SYSTEMUI ПОД LIDROID © SpellCaster

Автоматизирует инструкцию от sk0t (http://4pda.ru/forum/index.php?s=&showtopic=196047&view=findpost&p=12602328)

Требования для работы:
	* Установленная Java (JDK)
	* Папка, в которой будут размещены файлы Пакета, не должна иметь в пути пробелов и не-латинских символов
Требования для установки:
	* На целевом девайсе - права рута и доступ на запись в /system/app	

СОСТАВ ПАКЕТА:

	Исходные данные
		\qp_flash\ - *модифицированный* пакет замен файлов от sk0t для панели с фонариком(*1)
		\qp_noflash\ - *модифицированный* пакет замен файлов от sk0t для панели без фонарика(*1)
		\framework\ - пустая папка для файлов фреймворка

	Инструменты
		\7za.exe - архиватор
		\apktool.jar - программа для сборки-разборки apk
		\aapt.exe - программа, требующаяся для сборки apk (из комплекта apktool)
		\aapt_SDK.exe - программа, требующаяся для сборки apk (из комплекта Android SDK) - см. Прим.1
		\APK_worker.bat - главный скрипт
		\qpid_repl.js - скрипт для замены id в qpids.smali (запускается из APK_worker)
		\xml_add.js - скрипт для манипуляций с xml (запускается из APK_worker)
	
	Разное:
		\README - этот файл
		\QuickPanelSettings.apk - приложение для настройки отображаемых индикаторов (скачать с 4pda: см. по ссылке выше)

(*1) - модификация состоит в том, чтобы сделать из файлов qp_*flash\res\values-ru\strings.xml настоящие XML (добавление корневого XML узла). Наборы файлов, выложенные sk0t, без этой модификации РАБОТАТЬ ЗДЕСЬ НЕ БУДУТ.

ПРИМЕНЕНИЕ:

1) Скачать с целевого девайса файлы /system/framework/*.apk (ВСЕ с расширением apk!) (поместить в папку \framework) и /system/app/SystemUI.apk, поместить рядом с файлами Пакета.

2) Запустить APK_worker.bat

3) Указать режим: с фонариком или без

4) Для начала попробовать выполнить в автоматическом режиме (Step = 0). Пошаговый режим - для отладки, если возникают ошибки

5) Если всё благополучно, скрипт завершится без ошибок, а итоговое приложение будет сохранено как SystemUI_mod.apk

6) Записать из-под рекавери SystemUI_mod.apk на целевой девайс в /system/app (предварительно переименовать в SystemUI.apk). Перегрузить девайс.
Через adb это делается так:
	adb reboot recovery
	смонтировать /system через интерфейс рекавери
	adb push SystemUI_mod.apk /system/app/SystemUI.apk
	adb reboot
Можно и "на горячую" - adb push SystemUI_mod.apk /system/app/SystemUI.apk при включённом и загруженном девайсе, но есть опасность глюков.

6) Если возникнут ошибки запуска com.android.statusbar, посмотреть лог (выполнить в эмуляторе терминала на целевом девайсе либо через adb shell)
	logcat
Сохранить лог в файл:
	logcat > /sdcard/err.log

7) Поставить приложение QuickPanelSettings

ПРИМ. 1

Могут возникнуть ошибки при разборке-сборке apk файлов (в т.ч. фреймворка) при использовании вспомогательной программы aapt.exe. В этом случае попробовать программу aapt_SDK.exe (переименовать в aapt.exe)

ПРИМ. 2

используемые бинарные файлы:
APKTool: http://code.google.com/p/android-apktool/
7zip: http://www.7-zip.org/download.html
aapt_SDK: http://developer.android.com/sdk/index.html
qp_flash, qp_noflash: http://4pda.ru/forum/index.php?s=&showtopic=196047&view=findpost&p=12602328 (!!! требуют модификации - см. выше !!!)