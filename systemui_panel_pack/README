ПАКЕТ СКРИПТОВ ДЛЯ АВТОМАТИЗАЦИИ ИЗМЕНЕНИЯ SYSTEMUI ПОД LIDROID © SpellCaster

Автоматизирует инструкцию от sk0t (http://4pda.ru/forum/index.php?s=&showtopic=196047&view=findpost&p=12602328)
Поддерживает запуск не из текущей директории, а также из директорий с пробелами и нелатинскими символами
Картинки в наличии только для HDPI экранов

Требования для работы:
	* Установленная Java (JDK) http://www.oracle.com/technetwork/java/javase/downloads/index.html
Требования для установки модифицированного apk:
	* На целевом девайсе - права рута и доступ на запись в /system/app	

СОСТАВ ПАКЕТА:

	Исходные данные
		\qp_flash\ - *модифицированный* пакет замен файлов от sk0t для панели с фонариком(*1)
		\qp_noflash\ - *модифицированный* пакет замен файлов от sk0t для панели без фонарика(*1)
		\framework\ - пустая папка для файлов фреймворка

	Инструменты
		\7za.exe - архиватор
		\apktool.jar - программа для сборки-разборки apk
		\aapt_Custom.exe - программа, требующаяся для сборки apk (из комплекта apktool)
		\aapt_SDK.exe - программа, требующаяся для сборки apk (из комплекта Android SDK) - см. Прим.1
		\APK_worker.bat - главный скрипт
		\qpid_repl.js - скрипт для замены id в qpids.smali (запускается из APK_worker)
		\xml_add.js - скрипт для манипуляций с xml (запускается из APK_worker)
	
	Разное:
		\README - этот файл
		\QuickPanelSettings.apk - приложение для настройки отображаемых индикаторов (можно также скачать с 4pda: см. по ссылке выше)

(*1) - модификация состоит в том, чтобы сделать из файлов qp_*flash\res\values-ru\strings.xml настоящие XML (добавление корневого XML узла). Наборы файлов, выложенные sk0t, без этой модификации РАБОТАТЬ ЗДЕСЬ НЕ БУДУТ.

ПРИМЕНЕНИЕ:

1) Скачать с целевого девайса файлы /system/framework/*.apk (ВСЕ файлы с расширением apk!) (поместить в папку \framework) и /system/app/SystemUI.apk, поместить рядом с файлами Пакета.

2) Запустить APK_worker.bat

3) Указать режим: с фонариком или без

4) Для начала попробовать выполнить в автоматическом режиме (Step = 0). Пошаговый режим - для отладки, если возникают ошибки

5) Если всё благополучно, скрипт завершится без ошибок, а итоговое приложение будет сохранено как SystemUI_mod.apk. Если всё плохо :) - будут выданы ошибки. Желательно попробовать разобраться самим (например, если ошибка при сборке - почитать, на что именно ругается, возможно, при модификации были допущены ошибки). Если не получается - надо скопировать полный лог запуска (правая кнопка мыши - Изменить - Пометить, выделить весь текст с момента запуска скрипта, нажать Enter) и запостить в указанной теме на 4pda. Можно спросить у меня в личке, но в этом не очень много смысла, т.к. я слабо разбираюсь в природе процесса, просто автоматизировал инструкцию sk0t. Т.ч. будьте готовы, к редиректу в ту же самую тему :).
	
6) Записать из-под рекавери SystemUI_mod.apk на целевой девайс в /system/app (предварительно переименовать в SystemUI.apk). Перегрузить девайс.
Через adb это делается так:
	adb reboot recovery
	смонтировать /system через интерфейс рекавери (должно как-то выполняться командой, mount что-то там, но неохота искать)
	adb push SystemUI_mod.apk /system/app/SystemUI.apk
	adb reboot
Можно и "на горячую" - adb push SystemUI_mod.apk /system/app/SystemUI.apk при включённом и загруженном девайсе, но есть опасность глюков.

7) Если возникнут ошибки запуска com.android.statusbar, посмотреть лог (выполнить в эмуляторе терминала на целевом девайсе либо через adb shell)
	logcat
Сохранить лог в файл:
	logcat > /sdcard/err.log

8) Поставить приложение QuickPanelSettings

ПРИМ. 1

По умолчанию для разборки-сборки apk файлов (в т.ч. фреймворка) используется более свежая версия aapt.exe из SDK. Версия из набора apktool не умеет обрабатывать нестандартные названия ресурсов (вроде drawable-sw600dp-mdpi - выдает ошибку вида "invalid resource directory name: ...\systemui_panel_pack\
SystemUI\res/values-sw600dp-port"), поэтому версия из SDK более всеядна. Тем не менее, если эта версия у вас выдает ошибки при разборке или сборке, можно попробовать использовать apktool версию. Для этого откройте APK_worker.bat в текстовом редакторе и раскомментируйте строчку ":: set AAPT=aapt_Custom.exe" (просто уберите символы "::").

ПРИМ. 2

используемые бинарные файлы:
apktool.jar, aapt_Custom.exe: http://code.google.com/p/android-apktool/
7za.exe: http://www.7-zip.org/download.html
aapt_SDK.exe: http://developer.android.com/sdk/index.html (взято из Android SDK)
qp_flash, qp_noflash: http://4pda.ru/forum/index.php?s=&showtopic=196047&view=findpost&p=12602328 (!!! требуют модификации - см. выше !!!)